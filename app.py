import streamlit as st
import gspread

st.title("๐ต๏ธโโ๏ธ ูุญุต ุงูุงุชุตุงู ุจุฌูุฌู ุดูุช")

if st.button("ุงุถุบุท ููุง ูุงุฎุชุจุงุฑ ุงููุชุงุจุฉ ููุฑุงู"):
    try:
        # 1. ูุญุงููุฉ ูุฑุงุกุฉ ุงูููุงุชูุญ
        if "gcp_service_account" not in st.secrets:
            st.error("โ ุงูููุงุชูุญ (Secrets) ุบูุฑ ููุฌูุฏุฉ ูู ุงูุฅุนุฏุงุฏุงุช!")
        else:
            st.write("โ ุงูููุงุชูุญ ููุฌูุฏุฉ.")
            
            # 2. ูุญุงููุฉ ุงูุงุชุตุงู ุจุฌูุฌู
            gc = gspread.service_account_from_dict(st.secrets["gcp_service_account"])
            st.write("โ ุชู ุงูุงุชุตุงู ุจุฌูุฌู.")

            # 3. ูุญุงููุฉ ูุชุญ ุงูููู (ููุง ูุฑุจุท ุงููุฑุณ)
            file_name = "QararLeads"  # ุชุฃูุฏู ุฃู ูุฐุง ูุทุงุจู ุงุณู ูููู
            sh = gc.open(file_name) 
            st.write(f"โ ูุฌุฏูุง ุงูููู ุงููุณูู: {file_name}")

            # 4. ูุญุงููุฉ ุงููุชุงุจุฉ
            worksheet = sh.sheet1
            worksheet.append_row(["ุชุฌุฑุจุฉ", "test@email.com", "ูุฌุญูุง!"])
            st.success("๐ ุชูุช ุงููุชุงุจุฉ ุจูุฌุงุญ! ุงุฐูุจู ููููู ุงูุขู ูุชุฃูุฏู.")

    except Exception as e:
        st.error("โ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุงุชุตุงู:")
        st.warning(e) # ูุฐุง ุงูุณุทุฑ ุณูุทุจุน ููุง ุงููุดููุฉ ุจุงูุถุจุท
